<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/themes/listo-theme.min.css" />
  <link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />
  <link rel="stylesheet" href="css/themes/jquery.mobile.structure-1.4.5.min.css" />
  <script src="js/jquery.min.js"></script> 
  <script src="js/jquery.mobile-1.4.5.min.js"></script>
  <script src="js/moment.min.js"></script>
    <script>
  setTimeout(function() {
    if(localStorage.getItem("dataemail") == null || localStorage.getItem("dataemail") == "")
    {
    setTimeout(function(){
      $('#gcccsLoader').fadeOut();
      $('#imgLoader').fadeOut();
      
      location.href="main2.html";
        }, 1000);   
    }
    else
    {
    setTimeout(function(){
      
      $('#gcccsLoader').fadeOut();
      $('#imgLoader').fadeOut();
      location.href="main2.html";
        }, 1000);
    }
    }, 1000);
  </script>
  
  
   <title>PAGASA</title>
   
  <style>
.outer {
    display: table;
    position: absolute;
    height: 100%;
    width: 100%;
}

.middle {
    display: table-cell;
    vertical-align: middle;
}

.inner {
    margin-left: 10px;
    margin-right: auto; 
    width: 100%;
}
  </style>
</head>
  
  <body >
  <div data-role="page" id="indexPage" data-theme="a">
  <div data-role="content" >
    
      <img src="splash/splash.png" style="top: 30px; width:90%;margin-left:auto;margin-right:auto;display:block; position: relative;"><br/>
      <br/>
      <img id="imgLoader" src="img/ballRing.gif" style="width:15%;opacity:0.5;margin-left:auto;margin-right:auto;display:block; position: relative;">
          
        
  </div>
  </div>
  <script src="cordova.js"></script>
  <script>
	// Add to index.js or the first page that loads with your app.
// For Intel XDK and please add this to your app.js.

document.addEventListener('deviceready', function () {
  // Enable to debug issues.
  // window.plugins.OneSignal.setLogLevel({logLevel: 4, visualLevel: 4});
  
  var notificationOpenedCallback = function(jsonData) {
	console.log('didReceiveRemoteNotificationCallBack: ' + JSON.stringify(jsonData));
    //alert('didReceiveRemoteNotificationCallBack: ' + JSON.stringify(jsonData));
	var titleString = JSON.stringify(jsonData);
	var titleObject = JSON.parse(titleString);
	
	var title = titleObject.message;
	
	
	//and show alert
	//		alert(title);

			var d = new Date();
			var n = d.getMilliseconds();
			var testObject;
			var myArr={'id': '9999', 'message': 'Dummy Data', 'mdate': '01/01/2015', 'mtime':'12:00'};
			var myArr=[];
			var t=[];
			var retrieveObject;

			var momentDate = moment().format('MMMM DD, YYYY');
		
			if(localStorage.getItem('testObject') == null || localStorage.getItem('testObject') == ""){
				localStorage.setItem('testObject', JSON.stringify(myArr));
			}
			
			myArr = JSON.parse(localStorage.getItem('testObject'));
			testObject = {'id': n, 'message': title, 'mdate': momentDate, 'mtime': d.getHours() + ":" + ((d.getMinutes()<10)? "0" + d.getMinutes(): d.getMinutes())};
			myArr.push(testObject);
			localStorage.setItem('testObject', JSON.stringify(myArr));
			//alert('didReceiveRemoteNotificationCallBack: ' + JSON.stringify(jsonData));
	//alert(titleString);
	alert(title);
			location.href("history.html");
			
			
  };

  window.plugins.OneSignal.init("13de8dae-8127-4de8-992d-86d505f041e0",
                                 {googleProjectNumber: "183997037267"},
                                 notificationOpenedCallback);
  
  // Show an alert box if a notification comes in when the user is in your app.
  window.plugins.OneSignal.enableNotificationsWhenActive(true);
  
  window.plugins.OneSignal.enableInAppAlertNotification(true);
}, false);
  
  
  </script>
  
  </body>
</html>